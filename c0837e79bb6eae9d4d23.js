import"./styles.css";import{format,formatDistance,formatRelative,subDays}from"date-fns";import{icons}from"./iconsSVG.js";const theIcons=icons,form=document.querySelector("form"),searchInput=document.getElementById("search"),submitBtn=document.getElementById("submit-btn"),weatherSummary=document.querySelector(".weather-summary"),weatherLocation=document.querySelector(".location"),weatherTemp=document.querySelector(".temperatures"),weatherCondition=document.querySelector(".conditions"),weatherIcon=document.getElementById("icon"),weatherDescr=document.querySelector(".description"),weatherHours=document.querySelector(".hours"),weatherForecast=document.querySelector(".forecast");function searchWeather(e){getWeatherData(e).then((e=>(console.log(e),processWeatherDataObj(e)))).then((e=>{console.log("Obj: "+e.fiveDays[0]),displayWeather(e)}))}async function getWeatherData(e){const t=`https://weather.visualcrossing.com/VisualCrossingWebServices/rest/services/timeline/${e}?key=XGB7KF9RWZ2BQX5L49KB3TCRP`,o=await fetch(t,{mode:"cors"}),n=await o.json();return console.log(n),n}async function processWeatherDataObj(e){const t=[];return await new Promise((o=>{const n=e.days[0].hours,r=[];let i;for(n.forEach(((e,t)=>{let o;o=t<10?`0${t}:00`:`${t}:00`;let n={hour:o,icon:e.icon,temp:e.temp};r.push(n)})),i=0;i<6;i++){let o=e.days[i],n={date:format(new Date(o.datetime),"eeee"),temp:o.temp,icon:o.icon,summary:o.conditions};t.push(n)}return o({temp:e.currentConditions.temp,hourly:r,fiveDays:t,conditions:e.currentConditions.conditions,feelsLike:e.currentConditions.feelslike,humidity:e.currentConditions.humidity,icon:e.currentConditions.icon,precipitation:e.currentConditions.precip,precipProb:e.currentConditions.precipprob,uvIndex:e.currentConditions.uvindex,windSpeed:e.currentConditions.windspeed,dateTime:e.currentConditions.datetime,description:e.description,city:e.resolvedAddress})}))}function displayWeather(e){console.log(`******Your Weather for Today in ${e.city} ******`),weatherLocation.textContent=`${e.city}`,console.log(`Temperature: ${e.temp}`),weatherTemp.textContent=`${e.temp}Â° F`,console.log(`Conditions: ${e.conditions}`),weatherCondition.textContent=`${e.conditions}`,weatherIcon.src=theIcons[e.icon],console.log(`Icon: ${e.icon}`),console.log(`Time: ${e.dateTime} ${e.fiveDays[0].date}`),console.log(`Rain Probability: ${e.precipProb}`),console.log("********Hourly updates*******");for(let t=0;t<24;t++)console.log(`Hour: ${e.hourly[t].hour} - Temp: ${e.hourly[t].temp} - Icon: ${e.hourly[t].icon}`),displayHourWeather(e.hourly[t]);console.log("*******Next Five Days*******");for(let t=1;t<6;t++)console.log(`Day: ${e.fiveDays[t].date} - Temp: ${e.fiveDays[t].temp} - Condition: ${e.fiveDays[t].summary}`),displayForecast(e.fiveDays[t])}function displayHourWeather(e){let t=document.createElement("div");t.classList.add("hourDiv");let o=document.createElement("h4"),n=document.createElement("h6"),r=document.createElement("img"),i=document.createElement("p");t.appendChild(o),t.appendChild(n),t.appendChild(r),t.appendChild(i),weatherHours.appendChild(t),o.textContent=e.hour,n.textContent=e.temp}function displayForecast(e){let t=document.createElement("div");t.classList.add("nextDayDiv"),weatherForecast.appendChild(t);let o=document.createElement("h4"),n=document.createElement("h3"),r=document.createElement("img"),i=document.createElement("p");t.appendChild(o),t.appendChild(n),t.appendChild(r),t.appendChild(i),o.textContent=e.date,n.textContent=e.temp,r.src="",i.textContent=e.summary}submitBtn.addEventListener("click",(e=>{e.preventDefault(),searchWeather(searchInput.value)})),searchInput.addEventListener("keyup",(e=>{searchWeather(searchInput.value)}));